(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{124:function(e,t,n){},125:function(e,t,n){},126:function(e,t,n){},226:function(e,t,n){},230:function(e,t,n){},243:function(e,t,n){},269:function(e,t,n){},270:function(e,t,n){},271:function(e,t,n){},272:function(e,t,n){},273:function(e,t,n){},274:function(e,t,n){},275:function(e,t,n){"use strict";n.r(t);var r,s=n(1),c=n.n(s),a=n(110),i=n.n(a),o=n(5),u=n.n(o),j=n(10),d=n(2),l="".concat(window.location.protocol,"//").concat(window.location.host,"/"),b={endpoints:{login:l+"api/auth/login",register:l+"api/users",me:l+"api/auth/me",verify:l+"api/users/verify",reset_password:l+"api/users/reset-password",sendNewVerificationLink:l+"api/users/verify/new",sendForgotPasswordEmail:l+"api/users/forgot-password",avatar:l+"api/users/image",user:function(e){return l+"api/users/".concat(e)},logout:l+"api/auth/logout"}},m=n(4),p=n(11);!function(e){e.NOTIFY="NOTIFY",e.SET_USER="SET_USER"}(r||(r={}));var f=function(e){return{type:r.NOTIFY,payload:e}},O=function(e){return{type:r.SET_USER,payload:e}},h=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,r,s,c,a,i,o,j;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.method,s=void 0===r?"GET":r,c=t.headers,a=void 0===c?{}:c,i=t.body,e.prev=1,a&&(a.Accept="application/json, text/plain, */*",a["Content-Type"]="application/json"),i=JSON.stringify(i),e.next=6,fetch(n,{method:s,headers:a,body:i});case 6:return o=e.sent,e.next=9,o.json();case 9:return j=e.sent,e.abrupt("return",j);case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return",{success:!1,errors:[{msg:"Something went wrong"}]});case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(j.a)(u.a.mark((function e(t,n){var r,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.notify,e.prev=1,e.next=4,h({url:b.endpoints.me});case 4:return s=e.sent,e.abrupt("return",s.data.user);case 8:return e.prev=8,e.t0=e.catch(1),n(f(Object(p.a)(Object(p.a)({},r),{},{errors:[{msg:"Authentication failed. Something went wrong"}]}))),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),v=function(e,t){switch(t.type){case r.NOTIFY:return Object(p.a)(Object(p.a)({},e),{},{notify:t.payload});case r.SET_USER:return Object(p.a)(Object(p.a)({},e),{},{user:t.payload});default:return e}},w=n(0),g={notify:{errors:[],success:[]},user:void 0},y=Object(s.createContext)({state:g,dispatch:function(){}}),S=function(e){var t=e.children,n=Object(s.useReducer)(v,g),r=Object(m.a)(n,2),c=r[0],a=r[1];return Object(s.useEffect)((function(){x(c,a).then((function(e){return a(O(e))}))}),[]),Object(w.jsx)(y.Provider,{value:{state:c,dispatch:a},children:t})},N=(n(124),function(e){Object(d.a)(e);var t=Object(s.useContext)(y).state,n=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({url:b.endpoints.logout,method:"POST"});case 2:window.location.reload();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=t.user?Object(w.jsxs)("div",{className:"user-links",children:[Object(w.jsx)("a",{href:"/profile",children:" Profile "}),Object(w.jsx)("a",{onClick:n,children:" Logout "})]}):null;return Object(w.jsxs)("nav",{children:[Object(w.jsx)("a",{className:"logo",href:"/chat",children:"CHAT"}),r]})}),C=function(e){var t=e.children;return Object(w.jsxs)("div",{children:[Object(w.jsx)(N,{}),t]})},T=n(12),P=n(277),E=(n(125),function(e){var t=e.toast,n=e.deleteToast,r=e.expiresIn,c=Object(s.useState)(!1),a=Object(m.a)(c,2),i=a[0],o=a[1],u=function(){o(!0),setTimeout((function(){n(t.id)}),1e3)};return Object(s.useEffect)((function(){setTimeout(u,r)}),[]),Object(w.jsxs)("div",{className:"toast ".concat(t.type," ").concat(i?"expiration-animate":null," "),onClick:u,children:[Object(w.jsx)("p",{className:"toast-title",children:t.param?t.param.toCapitalize():t.type.toCapitalize()}),Object(w.jsx)("p",{children:t.msg})]})}),k=(n(126),function(e){Object(d.a)(e);var t=Object(s.useContext)(y),n=t.state,r=t.dispatch,c=Object(s.useState)([]),a=Object(m.a)(c,2),i=a[0],o=a[1],u=n.notify,j=u.errors,l=u.success,b=function(e){o((function(t){return t.filter((function(t){return t.id!==e}))}))};return Object(s.useEffect)((function(){if(l.length||j.length){var e=[];l.map((function(t){var n=Object(P.a)();e.push({msg:t.msg,type:"success",id:n})}));var t=[];j.map((function(e){var n=Object(P.a)();t.push({msg:e.msg,type:"error",id:n,param:e.param||void 0})})),o((function(n){return[].concat(Object(T.a)(n),e,t)})),r(f({errors:[],success:[]}))}}),[u]),Object(w.jsx)("div",{className:"toast-container",children:i.map((function(e){return Object(w.jsx)(E,{toast:e,deleteToast:b,expiresIn:5e3},e.id)}))})}),F=n(29),q=n(3),M=n(6),_=n(8),U=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{errors:!0,success:!0};if(t.success)return t.msg&&r.success?e(f(Object(p.a)(Object(p.a)({},n),{},{success:[{msg:t.msg}]}))):void 0;t.errors&&r.errors&&e(f(Object(p.a)(Object(p.a)({},n),{},{errors:t.errors})))},R=(n(49),function(e){Object(d.a)(e);var t=Object(s.useContext)(y),n=t.dispatch,r=t.state.notify,c=_.a().shape({email:_.c().email("Enter valid email").required("Email is required")});return Object(w.jsx)("div",{className:"form-container",children:Object(w.jsx)(M.d,{initialValues:{email:""},onSubmit:function(){var e=Object(j.a)(u.a.mark((function e(t){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({url:b.endpoints.sendForgotPasswordEmail,method:"POST",body:t});case 2:s=e.sent,U(n,s,r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),validationSchema:c,children:function(e){var t=e.isSubmitting;return Object(w.jsxs)(M.c,{children:[Object(w.jsx)("h2",{children:"Forget Password?"}),Object(w.jsxs)("div",{className:"field-container",children:[Object(w.jsx)("label",{htmlFor:"email",children:"Enter your email"}),Object(w.jsx)(M.a,{name:"email",component:"div",className:"error-message"}),Object(w.jsx)(M.b,{name:"email"})]}),Object(w.jsx)("button",{disabled:t,type:"submit",children:"Submit"})]})}})})}),I=function(e){return Object(d.a)(e),Object(w.jsx)(R,{})},V=n(117),Y=(n(226),["name"]),z=function(e){var t=e.name,n=Object(V.a)(e,Y),r=Object(M.e)(t),s=Object(m.a)(r,2),c=s[0];return Object(d.a)(s[1]),Object(w.jsxs)("div",{className:"field-container",children:[Object(w.jsx)("label",{htmlFor:t,children:t.toCapitalize()}),Object(w.jsx)(M.a,{name:t,component:"div",className:"error-message"}),Object(w.jsx)("input",Object(p.a)(Object(p.a)(Object(p.a)({},c),n),{},{name:t}))]})},L=function(e){Object(d.a)(e);var t=Object(s.useContext)(y),n=t.dispatch,r=t.state.notify,c=_.a().shape({email:_.c().email("Enter valid email").required("Email is required"),password:_.c().required("Password is required").min(8,"Password should be at least 8 charecters long")}),a=function(){var e=Object(j.a)(u.a.mark((function e(t){var s,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({url:b.endpoints.login,method:"POST",body:t});case 2:return s=e.sent,U(n,s,r),c=s.data.user,e.abrupt("return",n(O(c)));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)("div",{className:"form-container",children:Object(w.jsx)(M.d,{initialValues:{email:"",password:""},onSubmit:a,validationSchema:c,children:function(e){var t=e.isSubmitting;return Object(w.jsxs)(M.c,{children:[Object(w.jsx)(z,{name:"email"}),Object(w.jsx)(z,{name:"password",type:"password"}),Object(w.jsx)("button",{disabled:t,type:"submit",children:"Sign In"}),Object(w.jsx)(F.b,{to:"/forgot-password",className:"forgot-password",children:"Forgot password?"}),Object(w.jsxs)("div",{className:"sign-in",children:["Don't have an account? ",Object(w.jsx)(F.b,{to:"/sign-up",children:"Sign up"})]})]})}})})},A=function(e){return Object(d.a)(e),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(L,{})})},D=(n(230),function(e){var t=e.user;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("div",{className:"profile-conteiner",children:Object(w.jsx)("div",{className:"user-info",children:Object(w.jsxs)("p",{children:["Username: ",t.username]})})})})}),J=function(e){Object(d.a)(e);var t=window.location.href.split("/").pop(),n=Object(s.useState)(null),r=Object(m.a)(n,2),c=r[0],a=r[1];return Object(s.useEffect)((function(){t&&h({url:b.endpoints.user(t)}).then((function(e){a(e.data.user)}))}),[]),t&&c?Object(w.jsx)(D,{user:c}):null},B=function(e){Object(d.a)(e);var t=Object(s.useContext)(y),n=t.state,r=t.dispatch,c=n.notify,a=_.a().shape({username:_.c().required("Username is required"),email:_.c().email("Enter valid email").required("Email is required"),password:_.c().required("Password is required").min(8,"Password should be at least 8 charecters long"),confirm_password:_.c().required("Confirm password").oneOf([_.b("password"),null],"Passwords must match")}),i=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({url:b.endpoints.register,method:"POST",body:t});case 2:return n=e.sent,U(r,n,c),s=n.data.user,e.abrupt("return",r(O(s)));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)("div",{className:"form-container",children:Object(w.jsx)(M.d,{initialValues:{username:"",email:"",password:"",confirm_password:""},onSubmit:i,validationSchema:a,children:function(e){var t=e.isSubmitting;return Object(w.jsxs)(M.c,{children:[Object(w.jsx)(z,{name:"username"}),Object(w.jsx)(z,{name:"email"}),Object(w.jsx)(z,{name:"password",type:"password"}),Object(w.jsx)(z,{name:"confirm_password",type:"password"}),Object(w.jsx)("button",{disabled:t,type:"submit",children:"Sign Up"}),Object(w.jsxs)("div",{className:"sign-in",children:["Have an account? ",Object(w.jsx)(F.b,{to:"/sign-in",children:"Sign in"})]})]})}})})},H=function(e){return Object(d.a)(e),Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(B,{})})},Q=n(33),G=function(e){Object(d.a)(e);var t=Object(s.useContext)(y),n=t.dispatch,r=t.state.notify,c=Object(Q.parse)(window.location.search).token,a=Object(s.useState)(!1),i=Object(m.a)(a,2),o=i[0],l=i[1],p=_.a().shape({password:_.c().required("Password is required").min(8,"Password should be at least 8 charecters long"),confirm_password:_.c().required("Confirm password").oneOf([_.b("password"),null],"Passwords must match")}),f=function(){var e=Object(j.a)(u.a.mark((function e(t){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({url:b.endpoints.reset_password,method:"PUT",body:{password:t.password,token:c}});case 2:return s=e.sent,U(n,s,r),s.success&&l(!0),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o?Object(w.jsx)(q.a,{to:"/"}):Object(w.jsx)("div",{className:"form-container",children:Object(w.jsx)(M.d,{initialValues:{password:"",confirm_password:""},onSubmit:f,validationSchema:p,children:function(e){var t=e.isSubmitting;return Object(w.jsxs)(M.c,{children:[Object(w.jsxs)("div",{className:"field-container",children:[Object(w.jsx)("label",{htmlFor:"password",children:"Enter new password"}),Object(w.jsx)(M.a,{name:"password",component:"div",className:"error-message"}),Object(w.jsx)(M.b,{name:"password",type:"password"})]}),Object(w.jsxs)("div",{className:"field-container",children:[Object(w.jsx)("label",{htmlFor:"confirm_password",children:"Confirm Password"}),Object(w.jsx)(M.a,{name:"confirm_password",component:"div",className:"error-message"}),Object(w.jsx)(M.b,{name:"confirm_password",type:"password"})]}),Object(w.jsx)("button",{disabled:t,type:"submit",children:"Submit"})]})}})})},K=function(e){return Object(d.a)(e),Object(w.jsx)(G,{})},W=(n(243),function(e){Object(d.a)(e);var t=Object(s.useContext)(y),n=t.dispatch,r=t.state.notify,c=Object(Q.parse)(window.location.search),a=c.token,i=c.email,o=Object(s.useState)(!1),l=Object(m.a)(o,2),p=l[0],f=l[1],O=Object(s.useState)(!1),x=Object(m.a)(O,2),v=x[0],g=x[1];Object(s.useEffect)((function(){var e=b.endpoints.verify;h({url:e,method:"PUT",body:{token:a}}).then((function(e){U(n,e,r),e.errors&&f(!0),e.success&&g(!0)}))}),[]);var S=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h({url:b.endpoints.sendNewVerificationLink,method:"POST",body:{email:i}}).then((function(e){return U(n,e,r)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[p&&Object(w.jsxs)("p",{children:["Your link has expired. Click"," ",Object(w.jsx)("a",{onClick:S,style:{color:"#393bcf",textDecoration:"underline"},children:"here"})," ","to send a new link"," "]}),v&&Object(w.jsx)("p",{children:" You account has been verified "})]})}),X=function(e){var t=e.to,n=e.addNextQueryParam,r=e.redirectToNext,s=window.location.pathname;if(r){var c,a=Object(Q.parse)(window.location.search).next;return a?(a instanceof Array&&(a=a[0]),c=a,Object(w.jsx)(q.a,{to:"".concat(c)})):Object(w.jsx)(q.a,{to:"/"})}var i=n?s:"";return Object(w.jsx)(q.a,{to:"/".concat(t,"?next=").concat(i)})},Z=n(116),$=(n(269),n(270),function(e){var t=e.body,n=e.user;return Object(w.jsx)("div",{className:"message-body",children:Object(w.jsxs)("p",{children:[Object(w.jsx)("a",{href:"/profile/".concat(n.id),children:n.username}),": ",t]})})}),ee=function(e){var t=e.messages,n=e.sendMessage,r=e.users,s=e.isPrivateMessage;return Object(w.jsxs)("div",{className:"main-conteiner",children:[Object(w.jsxs)("div",{className:"chat-container",children:[Object(w.jsx)("div",{className:"messages-container",children:t.map((function(e,t){var n=e.body,r=e.user;return Object(w.jsx)($,{user:r,body:n},t)}))}),Object(w.jsx)(M.d,{initialValues:{message:""},onSubmit:function(){var e=Object(j.a)(u.a.mark((function e(t,r){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.resetForm,n(t.message,s),e.abrupt("return",c());case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.isSubmitting;return Object(w.jsxs)(M.c,{children:[Object(w.jsx)(z,{name:"message",autoComplete:"off"}),Object(w.jsx)("button",{disabled:t,type:"submit",children:"Send"})]})}})]}),Object(w.jsx)("div",{className:"user-list",children:null===r||void 0===r?void 0:r.map((function(e){return Object(w.jsx)("a",{href:"/profile/".concat(e.user.id),children:e.user.username})}))})]})},te=(n(271),function(e){var t=e.setRoom,n=e.setMessageToChannel,r=e.room,s=function(e){return e===r?"active":""};return Object(w.jsxs)("div",{className:"rooms-list",children:[Object(w.jsx)("h2",{children:"ROOMS"}),["general","channel 1","channel 2","channel 3"].map((function(e,r){return Object(w.jsx)("a",{onClick:function(){return r=e,n(),void t(r);var r},className:s(e),children:e.toCapitalize()},r)}))]})}),ne=(n(272),function(e){var t=e.users,n=e.setRoom,r=e.setMessageToUser,c=e.newMessanges,a=e.setNewMessanges,i=e.room,o=Object(s.useContext)(y).state,u=function(e){var t=c.filter((function(t){return t.user.username===e})).length;if(t)return Object(w.jsx)("i",{className:"new-messages-icon",children:t})},j=function(e){return e===i?"active":""};return Object(w.jsxs)("div",{className:"users-container",children:[Object(w.jsx)("h2",{children:"USERS"}),t.map((function(e){var t,s=e.user,c=e.id;return(null===(t=o.user)||void 0===t?void 0:t.username)===s.username?Object(w.jsx)("p",{className:j(c),children:s.username},c):Object(w.jsxs)("a",{className:j(c),onClick:function(){return function(e,t){r(),n(e),a((function(e){return e.filter((function(e){return e.user.username!==t}))}))}(c,s.username)},children:[s.username," ",u(s.username)]},c)}))]})}),re=(n(273),function(e){Object(d.a)(e);var t=Object(s.useState)(""),n=Object(m.a)(t,2),r=n[0],c=n[1],a=Object(s.useState)(),i=Object(m.a)(a,2),o=i[0],u=i[1],j=Object(s.useState)([]),b=Object(m.a)(j,2),p=b[0],f=b[1],O=Object(s.useState)([]),h=Object(m.a)(O,2),x=h[0],v=h[1],g=Object(s.useState)([]),S=Object(m.a)(g,2),N=S[0],C=S[1],P=Object(s.useState)(!1),E=Object(m.a)(P,2),k=E[0],F=E[1],q=Object(s.useContext)(y).state.user,M=Object(s.useRef)();Object(s.useEffect)((function(){M.current=Object(Z.io)("/"),M.current.on("your id",(function(e){u(e)})),M.current.emit("join server",{user:q}),M.current.emit("join room","general"),M.current.on("message",(function(e){e.isPrivate&&e.room!==r&&C((function(t){return[].concat(Object(T.a)(t),[e])})),v((function(t){return[].concat(Object(T.a)(t),[e])}))})),M.current.on("new user",(function(e){return f(e)})),M.current.on("joined",(function(e){c(e)}))}),[l]),Object(s.useEffect)((function(){C((function(e){return e.filter((function(e){return e.room!==r}))}))}),[x]);var _=function(e){var t;null===(t=M.current)||void 0===t||t.emit("join room",e)};return Object(w.jsxs)("div",{className:"chat-page",children:[Object(w.jsxs)("div",{className:"channels-container",children:[Object(w.jsx)(te,{setMessageToChannel:function(){return F(!1)},setRoom:_,room:r}),Object(w.jsx)(ne,{newMessanges:N,setNewMessanges:C,setMessageToUser:function(){return F(!0)},users:p,setRoom:_,room:r})]}),Object(w.jsx)(ee,{isPrivateMessage:k,room:r,messages:x.filter((function(e){return e.room===r})),sendMessage:function(e){var t,n={body:e,user:q,to:r,id:o,isPrivate:k};return null===(t=M.current)||void 0===t?void 0:t.emit("send message",n)},users:p.filter((function(e){return e.roomName===r}))})]})}),se=function(e){Object(d.a)(e);var t=Object(s.useContext)(y).state;return"undefined"===typeof t.user?null:Object(w.jsx)(F.a,{children:t.user?Object(w.jsxs)(q.d,{children:[Object(w.jsx)(q.b,{exact:!0,path:"/",children:Object(w.jsx)(q.a,{to:"/profile/".concat(t.user.id)})}),Object(w.jsx)(q.b,{path:"/verify",component:W}),Object(w.jsx)(q.b,{exact:!0,path:"/profile",children:Object(w.jsx)(q.a,{to:"/profile/".concat(t.user.id)})}),Object(w.jsx)(q.b,{path:"/profile/:id",component:J}),Object(w.jsx)(q.b,{path:"/chat",component:re}),Object(w.jsx)(X,{to:"/",redirectToNext:!0})]}):Object(w.jsxs)(q.d,{children:[Object(w.jsx)(q.b,{path:"/sign-in",component:A}),Object(w.jsx)(q.b,{path:"/verify",component:W}),Object(w.jsx)(q.b,{path:"/sign-up",component:H}),Object(w.jsx)(q.b,{path:"/forgot-password",component:I}),Object(w.jsx)(q.b,{path:"/reset-password",component:K}),Object(w.jsx)(X,{to:"sign-in",addNextQueryParam:!0})]})})};n(274);String.prototype.toCapitalize=function(){return this[0].toUpperCase()+this.slice(1)};var ce=function(){return Object(w.jsx)(S,{children:Object(w.jsxs)(C,{children:[Object(w.jsx)(k,{}),Object(w.jsx)(se,{})]})})},ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,278)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),s(e),c(e),a(e)}))};i.a.render(Object(w.jsx)(c.a.StrictMode,{children:Object(w.jsx)(ce,{})}),document.getElementById("root")),ae()},49:function(e,t,n){}},[[275,1,2]]]);
//# sourceMappingURL=main.04703b1b.chunk.js.map